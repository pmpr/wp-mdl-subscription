<?php
/*   _______________________________________
    |  Obfuscated by PMPR - Php Obfuscator  |
    |             680106b4bee6c             |
    |_______________________________________|
*/
 namespace Pmpr\Module\Subscription; use Pmpr\Common\Foundation\Data\PageInfo; use Pmpr\Common\Foundation\Interfaces\Constants; use Pmpr\Module\Subscription\Model\Plan; use Pmpr\Module\Subscription\Model\Subscription; use Pmpr\Module\Subscription\Subscription as Initiator; use WC_Coupon; use WP_Post; use WP_Term; use WP_User; class Engine extends Container { public function aackauiyyagmeqso() : array { $kekgkgqeyesmkywu = []; if ($omouioamescuegke = Plan::symcgieuakksimmu()) { $kekgkgqeyesmkywu = $omouioamescuegke->qyaiiayimwmuomey(false); } return $kekgkgqeyesmkywu; } public function sosokoyeikoyqeqy() : array { $aeqcomiyowaiwgyg = []; if ($kekgkgqeyesmkywu = $this->aackauiyyagmeqso()) { foreach ($kekgkgqeyesmkywu as $gesuaewsacmmwoeo) { $aeqcomiyowaiwgyg[Plan::symcgieuakksimmu()->mwyqswsaeeewsosm($gesuaewsacmmwoeo)] = $this->ikacayyusswgaoeg($gesuaewsacmmwoeo); } } return $aeqcomiyowaiwgyg; } public function qsgsmeykqoqkmywq(array $ekuqiqmikiicgoss) : string { return (string) $this->caokeucsksukesyo()->ywqgcuymeiswqyqc()->get($ekuqiqmikiicgoss, Constants::cwuyiqcqccegmmis, Constants::kqesaikwiwcgimuk); } public function kgmkyususkuskmws(array $ekuqiqmikiicgoss) { return $this->caokeucsksukesyo()->ywqgcuymeiswqyqc()->get($ekuqiqmikiicgoss, Constants::ecygggyugmmoeaky); } public function ikacayyusswgaoeg($gesuaewsacmmwoeo) : array { $aeqcomiyowaiwgyg = []; $omouioamescuegke = Plan::symcgieuakksimmu(); if ($acqqmqmcquukaqsc = $omouioamescuegke->waecsyqmwascmqoa($gesuaewsacmmwoeo, Constants::eeeoygaqqmoukaeg, [])) { foreach ($acqqmqmcquukaqsc as $ekuqiqmikiicgoss) { if (Constants::uueoqmeyyeiqyuku === $this->qsgsmeykqoqkmywq($ekuqiqmikiicgoss)) { $aeqcomiyowaiwgyg[$this->caokeucsksukesyo()->ywqgcuymeiswqyqc()->get($ekuqiqmikiicgoss, Constants::wqewegwyaeueiyae, 0)] = $ekuqiqmikiicgoss; } } } return $aeqcomiyowaiwgyg; } public function ysyuyiwueaissoaq($mkucggyaiaukqoce = false, bool $gmcgeogogyqsgawk = false) : ?array { static $kekgkgqeyesmkywu; $gesuaewsacmmwoeo = null; if ($mkucggyaiaukqoce) { $ycoeoaakqyskgykq = $this->caokeucsksukesyo()->issssuygyewuaswa()->iooowgsqoyqseyuu($mkucggyaiaukqoce, true); if (isset($kekgkgqeyesmkywu[$ycoeoaakqyskgykq])) { $gesuaewsacmmwoeo = $kekgkgqeyesmkywu[$ycoeoaakqyskgykq]; } else { if ($ycoeoaakqyskgykq) { $omouioamescuegke = Plan::symcgieuakksimmu(); $omcwcsgeyeyoiwyi = Subscription::symcgieuakksimmu(); $umwagewoweuckiso = $omcwcsgeyeyoiwyi->yqcmucyuwsyauoak($ycoeoaakqyskgykq); if ($umwagewoweuckiso) { $giuuywmgueegiiay = $omcwcsgeyeyoiwyi->waecsyqmwascmqoa($umwagewoweuckiso, Constants::kiwgokskimawckie); if ($giuuywmgueegiiay) { $gesuaewsacmmwoeo = $omouioamescuegke->iekyeyicoyyawomk()->akkkoiiymmamsauc($giuuywmgueegiiay); if ($gmcgeogogyqsgawk) { $gesuaewsacmmwoeo = $omouioamescuegke->scqakcemaqsqkema($gesuaewsacmmwoeo); } else { $gesuaewsacmmwoeo = (array) $gesuaewsacmmwoeo; } $gesuaewsacmmwoeo[Constants::uikygkewwaiowmwe] = $omcwcsgeyeyoiwyi->waecsyqmwascmqoa($umwagewoweuckiso, Constants::icymuyeowqaciyyu); } } } $kekgkgqeyesmkywu[$ycoeoaakqyskgykq] = $gesuaewsacmmwoeo; } } return $gesuaewsacmmwoeo; } public function swqakkikwgiumuwk() : bool { $qeoqkiisysuqyeqw = false; $uowwycywwssskuys = $this->caokeucsksukesyo()->giiecckwoyiawoyy()->ckaoiscoyuuosace(); $qsscskekauimcuww = $this->weysguygiseoukqw(Setting::iasieomsgmwmiago, [], [Constants::aisguagukaewucii => Constants::ckmqoekmugkggeym, Constants::wkweqssoakmmmguq => [Constants::ciyoccqkiamemcmm], Constants::wwgusigoaksqmwsm => function ($igqsaukqcqscimok) { return $this->caokeucsksukesyo()->ywqgcuymeiswqyqc()->get($igqsaukqcqscimok, Constants::ciyoccqkiamemcmm, ''); }]); $eouekqmooogkoqoo = $this->caokeucsksukesyo()->owgcciayoweymuws()->csqkegwecgkgyaqe($qsscskekauimcuww); if (preg_match("#{$eouekqmooogkoqoo}#", $uowwycywwssskuys, $meyiiwcswqmuggyg)) { $qeoqkiisysuqyeqw = true; } return $qeoqkiisysuqyeqw; } public function qwyoaaommsaiqagw($ycoeoaakqyskgykq = null) : bool { if (null === $ycoeoaakqyskgykq) { $ycoeoaakqyskgykq = $this->uwkmaywceaaaigwo()->issssuygyewuaswa()->qyeguewwsmosqcwc(); } return Subscription::symcgieuakksimmu()->qwyoaaommsaiqagw($ycoeoaakqyskgykq); } public function mqmggmcayogmcmmy($mkucggyaiaukqoce = false) : bool { $qeoqkiisysuqyeqw = false; $yoiguusocukqeayg = $this->caokeucsksukesyo()->issssuygyewuaswa(); if ($uugooykwcyiykise = $yoiguusocukqeayg->get($mkucggyaiaukqoce, true)) { $iagacugaygaqwuqa = (array) $this->weysguygiseoukqw(Setting::uaquuwiqcoeeykkc, []); foreach ($iagacugaygaqwuqa as $qegcmyuakccsyoeg) { if ($yoiguusocukqeayg->askmkgcmgekiqwsg($qegcmyuakccsyoeg, $uugooykwcyiykise, true)) { $qeoqkiisysuqyeqw = true; break; } } } return $this->ocksiywmkyaqseou(Initiator::mycmsckceqyeissy . 'bypass_restriction', $qeoqkiisysuqyeqw, $mkucggyaiaukqoce); } public function megowgmouaekgmuc(array $ywmkwiwkosakssii = []) { $uiwkaimiaukoeymk = []; if ($kekgkgqeyesmkywu = $this->aackauiyyagmeqso()) { foreach ($kekgkgqeyesmkywu as $gesuaewsacmmwoeo) { if ($uiwkaimiaukoeymk = $this->cmckygykskumaqqq($gesuaewsacmmwoeo, $ywmkwiwkosakssii)) { break; } } } return $uiwkaimiaukoeymk; } public function ygwsgkkguuguwyqg($mkucggyaiaukqoce = false, array $ywmkwiwkosakssii = []) { $gwykaiwqgaycyggs = true; if (!$this->ocksiywmkyaqseou(Initiator::mycmsckceqyeissy . 'check_access_bypass', false, $mkucggyaiaukqoce, $ywmkwiwkosakssii) && !$this->qymqiiikwaoaoeuw() && !$this->ceuwmaoweugiyuuw() && !$this->mqmggmcayogmcmmy($mkucggyaiaukqoce) && !$this->swqakkikwgiumuwk()) { $this->caokeucsksukesyo()->mskuyeumceaigegs()->debug(sprintf("checking %s content accessibility.", $this->caokeucsksukesyo()->ayueggmoqeeukqmq()->ycqquoiyyuesegsy())); if ($kekgkgqeyesmkywu = $this->aackauiyyagmeqso()) { $omouioamescuegke = Plan::symcgieuakksimmu(); $waoskoekyaciaiwm = $this->ysyuyiwueaissoaq($mkucggyaiaukqoce); foreach ($kekgkgqeyesmkywu as $gesuaewsacmmwoeo) { if ($uiwkaimiaukoeymk = $this->cmckygykskumaqqq($gesuaewsacmmwoeo, $ywmkwiwkosakssii)) { if ($waoskoekyaciaiwm && $omouioamescuegke->mwyqswsaeeewsosm($gesuaewsacmmwoeo) === $omouioamescuegke->mwyqswsaeeewsosm($waoskoekyaciaiwm)) { $gwykaiwqgaycyggs = $uiwkaimiaukoeymk; $this->caokeucsksukesyo()->mskuyeumceaigegs()->debug('User subscribed and has access to see this content.'); break; } $gwykaiwqgaycyggs = false; } else { $this->caokeucsksukesyo()->mskuyeumceaigegs()->debug(sprintf('can not find any rule to match this content in plan %s.', $omouioamescuegke->mwyqswsaeeewsosm($gesuaewsacmmwoeo))); } } if (!$gwykaiwqgaycyggs) { $this->caokeucsksukesyo()->mskuyeumceaigegs()->debug('user has not access to see this content.'); } } else { $this->caokeucsksukesyo()->mskuyeumceaigegs()->debug('plans list is empty.'); } } else { $this->caokeucsksukesyo()->mskuyeumceaigegs()->debug('Bypass by some conditions.'); } $sogksuscggsicmac = $this->ocksiywmkyaqseou(Initiator::mycmsckceqyeissy . 'check_access_result', $gwykaiwqgaycyggs, $mkucggyaiaukqoce, $ywmkwiwkosakssii); if (!$gwykaiwqgaycyggs && $sogksuscggsicmac) { $this->caokeucsksukesyo()->mskuyeumceaigegs()->debug('Filter give access to user.'); } return $sogksuscggsicmac; } public function mcgwiiiuwoqaueqs($kqekumyckgkmomos) : bool { $weksiguqgqscsoee = false; foreach ($this->aackauiyyagmeqso() as $gesuaewsacmmwoeo) { $aeqcomiyowaiwgyg = $this->ikacayyusswgaoeg($gesuaewsacmmwoeo); if ($aeqcomiyowaiwgyg && isset($aeqcomiyowaiwgyg[$kqekumyckgkmomos])) { $weksiguqgqscsoee = true; break; } } return $weksiguqgqscsoee; } public function cmckygykskumaqqq($gesuaewsacmmwoeo, array $ywmkwiwkosakssii = []) : array { $ockekyouswmoccck = false; $omouioamescuegke = Plan::symcgieuakksimmu(); $uiwkaimiaukoeymk = []; if ($acqqmqmcquukaqsc = $omouioamescuegke->waecsyqmwascmqoa($gesuaewsacmmwoeo, Constants::eeeoygaqqmoukaeg)) { $gkyciwoiiisgywcs = $this->caokeucsksukesyo()->ywqgcuymeiswqyqc(); $ywmkwiwkosakssii = $this->caokeucsksukesyo()->gyecsegqciqykomu()->ckscqqquyskscaaw($ywmkwiwkosakssii, [Constants::mgsccwumkcawaqcy => $this->caokeucsksukesyo()->kyqakacqeumicgag()->iqoacwuiemooiysg(), Constants::cwuyiqcqccegmmis => false, Constants::qggeimykqieaqooa => false, Constants::ouusyycueuuookig => false]); $ccamueccusigaaio = $gkyciwoiiisgywcs->get($ywmkwiwkosakssii, Constants::mgsccwumkcawaqcy); $oqiawgmgsmuwyqkw = $gkyciwoiiisgywcs->get($ywmkwiwkosakssii, Constants::cwuyiqcqccegmmis); foreach ($acqqmqmcquukaqsc as $ekuqiqmikiicgoss) { $couuyeucwooyseic = $this->qsgsmeykqoqkmywq($ekuqiqmikiicgoss); if ($oqiawgmgsmuwyqkw && $oqiawgmgsmuwyqkw !== $couuyeucwooyseic) { continue; } if (Constants::kqesaikwiwcgimuk === $couuyeucwooyseic) { if (is_numeric($ccamueccusigaaio)) { if ($post = $this->caokeucsksukesyo()->ayueggmoqeeukqmq()->get($ccamueccusigaaio, Constants::ckmqoekmugkggeym, true)) { $ccamueccusigaaio = $post; } else { if ($iwewcwusemqaiggk = $this->caokeucsksukesyo()->kckogqkiycqeumoa()->get($ccamueccusigaaio)) { $ccamueccusigaaio = $iwewcwusemqaiggk; } } } $qisgacickokaaius = $gkyciwoiiisgywcs->get($ywmkwiwkosakssii, Constants::qggeimykqieaqooa); $qkemkecqsecsguwy = $gkyciwoiiisgywcs->get($ywmkwiwkosakssii, Constants::ouusyycueuuookig); if ($qisgacickokaaius && $qisgacickokaaius !== $gkyciwoiiisgywcs->get($ekuqiqmikiicgoss, Constants::qggeimykqieaqooa, Constants::ssmskyqgcmeiayco)) { continue; } if ($qkemkecqsecsguwy && $qkemkecqsecsguwy !== $gkyciwoiiisgywcs->get($ekuqiqmikiicgoss, Constants::ouusyycueuuookig, Constants::uwycywkimsycqwcy)) { continue; } if ($ccamueccusigaaio instanceof WP_Post) { $ockekyouswmoccck = $this->agykmooqsqqiswku($ccamueccusigaaio, $ekuqiqmikiicgoss); } else { if ($ccamueccusigaaio instanceof WP_Term) { $ockekyouswmoccck = $this->smwqosckeiecmcgi($ccamueccusigaaio, $ekuqiqmikiicgoss); } else { if ($ccamueccusigaaio instanceof PageInfo) { if ($ccamueccusigaaio->is(Constants::cwswygwykwgsqiwu) || $ccamueccusigaaio->is(Constants::imywcsggckkcywgk)) { $post = $this->uwkmaywceaaaigwo()->owicscwgeuqcqaig()->imgymusqgccqsqqq(); if ($post instanceof WP_Post) { $ockekyouswmoccck = $this->agykmooqsqqiswku($post, $ekuqiqmikiicgoss); } } else { if ($ccamueccusigaaio->is(Constants::gmmygyiecgmggaam)) { $iwewcwusemqaiggk = $this->uwkmaywceaaaigwo()->owicscwgeuqcqaig()->imgymusqgccqsqqq(); if ($iwewcwusemqaiggk instanceof WP_Term) { $ockekyouswmoccck = $this->smwqosckeiecmcgi($iwewcwusemqaiggk, $ekuqiqmikiicgoss); } } else { $ockekyouswmoccck = $this->owkmysgauumouuaw($ccamueccusigaaio, $ekuqiqmikiicgoss); } } } else { if ($this->caokeucsksukesyo()->gyecsegqciqykomu()->wmcwegoisyeeosqu($ccamueccusigaaio)) { $ockekyouswmoccck = $this->ykmyogaoggekoisw($ccamueccusigaaio, $ekuqiqmikiicgoss); } } } } } else { $ockekyouswmoccck = $this->cqeueuwcsgyigwgu($ccamueccusigaaio, $ekuqiqmikiicgoss); } if ($ockekyouswmoccck) { if (Constants::ccyeycyyykwuymsy === $gkyciwoiiisgywcs->get($ekuqiqmikiicgoss, Constants::wuawcaggsyeaaswe, Constants::ackcaikowcokggsc)) { $uiwkaimiaukoeymk = []; $this->caokeucsksukesyo()->mskuyeumceaigegs()->debug('this content excluded by rule.'); break; } $uiwkaimiaukoeymk = $ekuqiqmikiicgoss; } } } return $uiwkaimiaukoeymk; } private function cqeueuwcsgyigwgu($kqekumyckgkmomos, array $ekuqiqmikiicgoss) : bool { $ackyuiceseoucyuw = false; if ($kqekumyckgkmomos && Constants::uueoqmeyyeiqyuku === $this->qsgsmeykqoqkmywq($ekuqiqmikiicgoss)) { $ackyuiceseoucyuw = (int) $kqekumyckgkmomos === (int) $this->caokeucsksukesyo()->ywqgcuymeiswqyqc()->get($ekuqiqmikiicgoss, Constants::wqewegwyaeueiyae, 0); } return $ackyuiceseoucyuw; } private function agykmooqsqqiswku(WP_Post $post, array $ekuqiqmikiicgoss) : bool { $ewkaiqqqacmkgqws = false; switch ($this->kgmkyususkuskmws($ekuqiqmikiicgoss)) { case Constants::mswoacegomcucaik: $seumokooiykcomco = $this->caokeucsksukesyo()->ayueggmoqeeukqmq(); $gcqseksiskwueksc = $seumokooiykcomco->iooowgsqoyqseyuu($post); $useksmwkuswkwcqg = $seumokooiykcomco->gueasuouwqysmomu($gcqseksiskwueksc); if (Constants::oguseymmyyoyaako !== $useksmwkuswkwcqg || !$this->cuisyayqcsoqcueq($gcqseksiskwueksc)) { $gkyciwoiiisgywcs = $this->caokeucsksukesyo()->ywqgcuymeiswqyqc(); if ($sciomagaqmgggsiu = $gkyciwoiiisgywcs->get($ekuqiqmikiicgoss, Constants::qiqyassswqeuwsuu, 0)) { $uuyoeicyoayimaoa = $gkyciwoiiisgywcs->get($ekuqiqmikiicgoss, Constants::cgiswgcumueqgcmw, 0); if ($uuyoeicyoayimaoa > 0) { $umwqusowiqmyseom = $gkyciwoiiisgywcs->get($ekuqiqmikiicgoss, Constants::awkcoioakcaougmq, Constants::omaksceqmigeaoko); $sikaymiwcesagayc = $gkyciwoiiisgywcs->get($ekuqiqmikiicgoss, Constants::gqiasegggowomgie, Constants::kumuoysauoagaiiy); $wyoiwuqokyeeuguk = $seumokooiykcomco->ciugwooasaqcywas($sciomagaqmgggsiu, [Constants::gqiasegggowomgie => $sikaymiwcesagayc, Constants::awkcoioakcaougmq => $umwqusowiqmyseom, Constants::goqgcigmiawyauai => $uuyoeicyoayimaoa], Constants::oyaoekcogwkcekcc); $ewkaiqqqacmkgqws = in_array($gcqseksiskwueksc, $wyoiwuqokyeeuguk); } else { $ewkaiqqqacmkgqws = in_array($useksmwkuswkwcqg, $sciomagaqmgggsiu); } } if (!$ewkaiqqqacmkgqws && ($uyuaosigqymaqsaa = $gkyciwoiiisgywcs->get($ekuqiqmikiicgoss, Constants::cqgykecuqgwgecgk))) { foreach ($uyuaosigqymaqsaa as $iwewcwusemqaiggk) { $kesssewsiegssiya = $this->caokeucsksukesyo()->kckogqkiycqeumoa()->yyoeeseewqmmyaee($iwewcwusemqaiggk); if ($this->uwkmaywceaaaigwo()->ayueggmoqeeukqmq()->smyaggwyeweiqiie($iwewcwusemqaiggk, $kesssewsiegssiya, $gcqseksiskwueksc)) { $ewkaiqqqacmkgqws = true; break; } } } if (!$ewkaiqqqacmkgqws && ($wyoiwuqokyeeuguk = $gkyciwoiiisgywcs->get($ekuqiqmikiicgoss, Constants::qgmuskygocwmouos))) { $ewkaiqqqacmkgqws = in_array($gcqseksiskwueksc, $wyoiwuqokyeeuguk); } } break; case Constants::qeesogequqsoiymo: $ewkaiqqqacmkgqws = $this->ykmyogaoggekoisw($this->caokeucsksukesyo()->ayueggmoqeeukqmq()->ycqquoiyyuesegsy($post, true), $ekuqiqmikiicgoss); break; } return $ewkaiqqqacmkgqws; } private function smwqosckeiecmcgi(WP_Term $iwewcwusemqaiggk, array $ekuqiqmikiicgoss) : bool { $ewkaiqqqacmkgqws = false; switch ($this->kgmkyususkuskmws($ekuqiqmikiicgoss)) { case Constants::yoayaissyomokiui: $ucicuwcaawugkseg = $this->caokeucsksukesyo()->kckogqkiycqeumoa()->iooowgsqoyqseyuu($iwewcwusemqaiggk, true); if ($seyqqsmuaiegkeeq = $this->caokeucsksukesyo()->ywqgcuymeiswqyqc()->get($ekuqiqmikiicgoss, Constants::emcyuiagkcgsckma, [])) { $ewkaiqqqacmkgqws = in_array($this->caokeucsksukesyo()->kckogqkiycqeumoa()->yyoeeseewqmmyaee($iwewcwusemqaiggk), $seyqqsmuaiegkeeq, true); } if (!$ewkaiqqqacmkgqws && ($uyuaosigqymaqsaa = $this->caokeucsksukesyo()->ywqgcuymeiswqyqc()->get($ekuqiqmikiicgoss, Constants::ucoiewcoucauqwko, []))) { $ewkaiqqqacmkgqws = in_array($ucicuwcaawugkseg, $uyuaosigqymaqsaa); } break; case Constants::qeesogequqsoiymo: $ewkaiqqqacmkgqws = $this->ykmyogaoggekoisw($this->caokeucsksukesyo()->kckogqkiycqeumoa()->qmgcisuuikgmqcsu($iwewcwusemqaiggk), $ekuqiqmikiicgoss); break; } return $ewkaiqqqacmkgqws; } private function owkmysgauumouuaw(PageInfo $qsqyqaucskiesoiq, array $ekuqiqmikiicgoss) : bool { $ewkaiqqqacmkgqws = false; switch ($this->kgmkyususkuskmws($ekuqiqmikiicgoss)) { case Constants::uouymeyqasaeckso: if ($qsqyqaucskiesoiq->is(Constants::uouymeyqasaeckso)) { $sciomagaqmgggsiu = (array) $this->caokeucsksukesyo()->ywqgcuymeiswqyqc()->get($ekuqiqmikiicgoss, Constants::yyoaeaaaquyigiim, []); $ewkaiqqqacmkgqws = !empty($sciomagaqmgggsiu) && in_array($qsqyqaucskiesoiq->gueasuouwqysmomu(), $sciomagaqmgggsiu, true); } break; case Constants::qeesogequqsoiymo: $ewkaiqqqacmkgqws = $this->ykmyogaoggekoisw($qsqyqaucskiesoiq->ycqquoiyyuesegsy(), $ekuqiqmikiicgoss); break; } return $ewkaiqqqacmkgqws; } private function ykmyogaoggekoisw(string $migiiksoiymissge, array $ekuqiqmikiicgoss) : bool { $ewkaiqqqacmkgqws = false; if (Constants::qeesogequqsoiymo === $this->kgmkyususkuskmws($ekuqiqmikiicgoss) && ($eouekqmooogkoqoo = $this->caokeucsksukesyo()->ywqgcuymeiswqyqc()->get($ekuqiqmikiicgoss, Constants::qakegsaikiimcmkc))) { $gmigwwwmwemyaayy = $this->uwkmaywceaaaigwo()->giiecckwoyiawoyy()->gmigwwwmwemyaayy(); $ucccueqywigcukcc = $this->caokeucsksukesyo()->gyecsegqciqykomu()->gwckaecmqskyysui([$eouekqmooogkoqoo]); $aaokuekaimigoyue = preg_quote($this->caokeucsksukesyo()->owgcciayoweymuws()->wiecmkiugmyyqiqc($gmigwwwmwemyaayy, '', $migiiksoiymissge), '/'); if (preg_match("#{$ucccueqywigcukcc}#", $aaokuekaimigoyue, $meyiiwcswqmuggyg)) { $ewkaiqqqacmkgqws = $meyiiwcswqmuggyg[0] === $aaokuekaimigoyue; } } return $ewkaiqqqacmkgqws; } }
